(function(t){function e(e){for(var r,n,i=e[0],c=e[1],l=e[2],d=0,p=[];d<i.length;d++)n=i[d],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&p.push(a[n][0]),a[n]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);o&&o(e);while(p.length)p.shift()();return u.push.apply(u,l||[]),s()}function s(){for(var t,e=0;e<u.length;e++){for(var s=u[e],r=!0,i=1;i<s.length;i++){var c=s[i];0!==a[c]&&(r=!1)}r&&(u.splice(e--,1),t=n(n.s=s[0]))}return t}var r={},a={app:0},u=[];function n(e){if(r[e])return r[e].exports;var s=r[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=r,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(s,r,function(e){return t[e]}.bind(null,r));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var o=c;u.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";s("85ec")},"0d0b":function(t,e,s){"use strict";s("ac71")},"56d7":function(t,e,s){"use strict";s.r(e);s("14d9");var r=s("2b0e"),a=s("8c4f"),u=s("2f62"),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view",{staticClass:"view"}),s("Queue"),s("Player")],1)},i=[],c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"queue"},[s("p",{staticClass:"title"},[s("span",[t._v(" Queue"),s("span",{staticClass:"soft"},[t._v(" • "+t._s(t.queue.length)+" tracks")])]),t.queue.length>0?s("span",{staticClass:"material-icons reset",on:{click:t.resetQueue}},[t._v(" clear ")]):t._e()]),t._l(t.queue,(function(t,e){return s("TrackItem",{key:t.id,attrs:{track:t,"queue-btn":!1,index:e}})}))],2)},l=[],o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"track"},[s("img",{staticClass:"picture-song clickable",attrs:{src:t.track.album.cover_small,alt:"Picture"},on:{click:t.playTrack}}),s("p",[s("b",{class:{clickable:!0,isPlaying:t.isPlaying},on:{click:t.playTrack}},[t._v(t._s(t.track.title))]),s("br"),t._v(" "+t._s(t.track.artist.name)+" "),s("br"),t.queueBtn?s("a",{staticClass:"soft clickable",attrs:{id:"add"},on:{click:t.addToQueue}},[t._v(" Add to queue")]):t._e()])])},d=[],p={name:"TrackItem",props:{track:Object,queueBtn:Boolean,index:Number},computed:{currentTrack(){return this.$store.state.currentTrack},isPlaying(){return this.currentTrack&&this.currentTrack.id===this.track.id}},methods:{playTrack(){this.queueBtn?(this.$store.dispatch("addToQueue",this.track),this.$store.dispatch("playLastTrack",this.track)):this.$store.dispatch("playAt",this.index)},addToQueue(){this.$store.dispatch("addToQueue",this.track)}}},h=p,f=(s("bc7d"),s("2877")),m=Object(f["a"])(h,o,d,!1,null,"62898e59",null),v=m.exports,_={name:"Queue",components:{TrackItem:v},computed:{queue(){return this.$store.state.queue}},methods:{resetQueue(){this.$store.dispatch("resetQueue")}}},k=_,y=(s("cbb7"),Object(f["a"])(k,c,l,!1,null,"145fd33d",null)),b=y.exports,T=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"player"},[t.currentTrack?t._e():s("div",{staticClass:"infos"}),t._v(" "),t.currentTrack?s("div",{staticClass:"infos"},[s("img",{staticClass:"picture",attrs:{src:t.currentTrack.album.cover,alt:"Picture"}}),s("div",[s("b",[t._v(t._s(t.currentTrack.title))]),s("br"),s("span",[t._v(t._s(t.currentTrack.artist.name))])])]):t._e(),s("div",{staticClass:"controls"},[s("span",{staticClass:"arrow",on:{click:t.previous}},[t._v("◂◂")]),s("audio",{ref:"audioPlayer",attrs:{id:"audioPlayer",controls:"",autoplay:"",src:t.preview}},[t._v(" Your browser does not support the "),s("code",[t._v("audio")]),t._v(" element. ")]),s("span",{staticClass:"arrow",on:{click:t.next}},[t._v("▸▸")])]),s("DeezerCredits")],1)},P=[],g=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},q=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"text"},[t._v("Powered by")]),r("img",{attrs:{height:"48",src:s("cf05")}})])}],C=(s("de20"),{}),w=Object(f["a"])(C,g,q,!1,null,"777210d2",null),x=w.exports,$={name:"Player",components:{DeezerCredits:x},mounted(){this.$refs.audioPlayer.onended=()=>{this.next()}},computed:{currentTrack(){return this.$store.state.currentTrack},preview(){return this.$store.state.preview}},watch:{preview:function(t){null===t&&(this.$refs.audioPlayer.pause(),this.$refs.audioPlayer.currentTime=0)}},methods:{next(){this.$store.dispatch("next")},previous(){this.$store.dispatch("previous")}}},Q=$,j=(s("a281"),Object(f["a"])(Q,T,P,!1,null,"40f9047e",null)),O=j.exports,I={name:"App",components:{Queue:b,Player:O}},E=I,S=(s("034f"),Object(f["a"])(E,n,i,!1,null,null,null)),B=S.exports,A=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("h1",[t._v("Playlists")]),s("div",{staticClass:"playlists"},t._l(t.playlists,(function(e){return s("div",{key:e.id,staticClass:"playlist-item"},[s("router-link",{staticClass:"clickable",attrs:{to:"/playlists/"+e.id}},[s("img",{attrs:{src:e.picture_medium,alt:"Picture"}})]),s("b",[t._v(t._s(e.title))]),e.user?s("span",[t._v(t._s(e.user.name))]):t._e()],1)})),0)])},M=[],L={name:"Home",created(){this.fetchPlaylists()},data(){return{playlists:"Fetching playlists..."}},methods:{fetchPlaylists(){fetch("/api/playlists/top/20",{method:"GET"}).then(t=>t.json()).then(t=>{this.playlists=t.data}).catch(t=>{console.log(t)})}}},D=L,F=(s("df34"),Object(f["a"])(D,A,M,!1,null,"d44bc89c",null)),Y=F.exports,z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("p",[s("router-link",{attrs:{to:"/"}},[t._v("< Back to playlists")])],1),s("div",{staticClass:"header"},[s("img",{staticClass:"picture",attrs:{src:t.picture,alt:"Picture"}}),s("div",[s("p",{staticClass:"soft"},[t._v("PLAYLIST")]),s("h2",[t._v(t._s(this.title))]),s("p",[s("span",{staticClass:"soft"},[t._v("By")]),t._v(" "+t._s(t.creator)+" ")]),s("p",{staticClass:"soft"},[t._v(" "+t._s(this.year+" • "+this.nbTracks+" songs • "+this.duration+" minutes")+" ")])])]),t._l(t.tracks,(function(t,e){return s("TrackItem",{key:t.id,attrs:{track:t,"queue-btn":!0,index:e}})}))],2)},G=[],H={name:"Playlist",components:{TrackItem:v},created(){this.fetchPlaylist()},data(){return{title:"Fetching playlist...",tracks:null,picture:null,creator:null,year:null,nbTracks:null,duration:null}},methods:{fetchPlaylist(){fetch("/api/playlists/"+this.$route.params.id,{method:"GET"}).then(t=>t.json()).then(t=>{this.title=t.title,this.tracks=t.tracks.data,this.picture=t.picture_big,this.creator=t.creator.name,this.year=new Date(t.creation_date).getFullYear(),this.nbTracks=t.nb_tracks,this.duration=Math.round(t.duration/60)}).catch(t=>{console.log(t)})}}},J=H,N=(s("0d0b"),Object(f["a"])(J,z,G,!1,null,"1418fddc",null)),K=N.exports;r["a"].use(a["a"]),r["a"].use(u["a"]);const R=new a["a"]({mode:"history",routes:[{path:"/",name:"Home",component:Y},{path:"/playlists/:id",name:"Playlist",component:K}]}),U=new u["a"].Store({state:{currentTrack:null,preview:null,queue:[],queuePtr:0},mutations:{setCurrentTrack(t,e){t.currentTrack=e,t.preview=e.preview},pushInQueue(t,e){t.queue.push(e)},setQueueIndex(t,e){t.queuePtr=e},resetQueue(t){t.queue=[],t.queuePtr=0,t.currentTrack=null,t.preview=null}},actions:{playLastTrack({commit:t}){t("setQueueIndex",this.state.queue.length-1),t("setCurrentTrack",this.state.queue[this.state.queuePtr])},playAt({commit:t},e){t("setQueueIndex",e),t("setCurrentTrack",this.state.queue[this.state.queuePtr])},addToQueue({commit:t},e){t("pushInQueue",e),1===this.state.queue.length&&t("setCurrentTrack",e)},next({commit:t}){this.state.queuePtr+1<this.state.queue.length&&(t("setQueueIndex",this.state.queuePtr+1),t("setCurrentTrack",this.state.queue[this.state.queuePtr]))},previous({commit:t}){this.state.queuePtr>0&&(t("setQueueIndex",this.state.queuePtr-1),t("setCurrentTrack",this.state.queue[this.state.queuePtr]))},resetQueue({commit:t}){t("resetQueue")}}});new r["a"]({router:R,store:U,render:t=>t(B)}).$mount("#app")},"5c4d":function(t,e,s){},7233:function(t,e,s){},"85ec":function(t,e,s){},"873c":function(t,e,s){},a281:function(t,e,s){"use strict";s("5c4d")},a3d0:function(t,e,s){},ac71:function(t,e,s){},b33d:function(t,e,s){},bc7d:function(t,e,s){"use strict";s("b33d")},cbb7:function(t,e,s){"use strict";s("873c")},cf05:function(t,e,s){t.exports=s.p+"img/logo.6fe27f5c.png"},de20:function(t,e,s){"use strict";s("a3d0")},df34:function(t,e,s){"use strict";s("7233")}});
//# sourceMappingURL=app.71c2555e.js.map